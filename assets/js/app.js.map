{"version":3,"sources":["webpack:///webpack/bootstrap 061e11e3dc5936891986","webpack:///./src/js/app.js","webpack:///./src/js/variables.js","webpack:///./src/js/flickr.js","webpack:///./src/js/canvas.js","webpack:///./src/js/canvas_tools.js","webpack:///./src/js/event_listeners.js"],"names":["search_box","document","querySelector","search_form","thumbnails_container","tools","canvas_container","white_balance_slider","brightness_slider","canvas","draw_canvas","draw_canvas_ctx","getContext","draw","ctx","getImages","flickr_images","make_flickr_url","method","param","api_key","flickr_url","search_string","value","tags","split","i","length","make_flickr_api_request","Promise","resolve","reject","xhr","XMLHttpRequest","open","onload","status","response","statusText","onerror","send","page","images","search_flickr","then","json_string","JSON","parse","photos","photo","photos_array","photos_start","photos_end","push","photos_array_string","getImage","id","all","photos_array_strings","photo_sources","sizes_array","sizes","size","thumbnail","large","width","height","n","label","source","change_canvas_size","make_image_list","img_width","img_height","img_src","offsetWidth","offsetHeight","innerHTML","createElement","setAttribute","appendChild","addEventListener","dataset","load_image","url","img","Image","clearRect","options","points","drawImage","style","crossOrigin","src","Filters","image_flipped","brightness_value","temp","draw_toggled","drawing","undo_stack","redo_stack","prototype","flip_image","save","translate","scale","restore","color_temp_to_RGB","r","g","b","Math","min","max","log","pow","brightness","process","a","white_balance","color","nr","ng","nb","point","beginPath","arc","x","y","PI","fill","closePath","func","image_data","getImageData","data","row","column","ret","putImageData","link","filename","Date","href","toDataURL","download","add_to_history","console","undo","popped_undo_stack","pop","new_options","Object","assign","set_sliders","redo","popped_redo_stack","render","Filter","make_event_listeners","e","preventDefault","getMouseXY","draw_points","new_points","classList","add","remove","pageX","pageY","clientX","body","scrollLeft","documentElement","clientY","scrollTop","offsetLeft","offsetTop"],"mappings":"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","file":"app.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 061e11e3dc5936891986","import {change_canvas_size} from './canvas';\r\nimport make_event_listeners from './event_listeners';\r\n\r\nmake_event_listeners();\r\nchange_canvas_size();\n\n\n// WEBPACK FOOTER //\n// ./src/js/app.js","export const search_box = document.querySelector(\".flickr_search_box\");\r\nexport const search_form = document.querySelector(\".flickr_search_form\");\r\nexport const thumbnails_container = document.querySelector(\".thumbnails_container\");\r\nexport const tools = document.querySelector(\"#tools\");\r\nexport const canvas_container = document.querySelector(\"#canvas_container\");\r\nexport const white_balance_slider = document.querySelector(\"#white_balance_slider\");\r\nexport const brightness_slider = document.querySelector(\"#brightness_slider\");\r\nexport const canvas = document.querySelector(\".canvas\");\r\nexport const draw_canvas = document.querySelector(\".draw_canvas\");\r\nexport const draw_canvas_ctx = document.querySelector(\".draw_canvas\").getContext('2d');\r\nexport const draw = document.querySelector(\".draw\");\r\nexport const ctx = canvas.getContext('2d');\n\n\n// WEBPACK FOOTER //\n// ./src/js/variables.js","const search_box = document.querySelector(\".flickr_search_box\");\r\nconst search_form = document.querySelector(\".flickr_search_form\");\r\n\r\nlet flickr_images = [];\r\n\r\n/**\r\n * Method to make a flickr_url\r\n * @param  {string} method What method to call from the flickr.api\r\n * @param  param  Extra parameters for the URL\r\n * @return {string}        API URL\r\n */\r\nfunction make_flickr_url(method, param) {\r\n\tconst api_key = \"def6981d1e064bf25f16a7542d848ace\";\r\n\tvar flickr_url = \"https://api.flickr.com/services/rest/?nojsoncallback=1&format=json&method=\"+method+\"&api_key=\"+api_key;\r\n\r\n\t\r\n\t // If we are doing a search on photos\r\n\tif(method == 'flickr.photos.search') {\r\n\t\t// Add a tags parameter to the URL\r\n\t\tflickr_url += \"&tags=\";\r\n\r\n\t\t// Get the tags from the search box\r\n\t\t// and split it based on comma\r\n\t\tvar search_string = search_box.value;\r\n\t\tvar tags = search_string.split(',');\r\n\r\n\t\t// Add them to the URL, separated by comma\r\n\t\tfor(var i = 0;i < tags.length;i++) {\r\n\t\t\tif(i !== 0) {\r\n\t\t\t\tflickr_url += \",\";\r\n\t\t\t}\r\n\r\n\t\t\tflickr_url += tags[i];\r\n\t\t}\r\n\t}\r\n\tif(method == 'flickr.photos.getSizes') {\r\n\t\tflickr_url += \"&photo_id=\" + param;\r\n\t}\r\n\r\n\treturn flickr_url;\r\n}\r\n\r\n/**\r\n * Make a flickr API request\r\n * @param  {string} method What method to call from the flickr.api\r\n * @param  param  Extra parameters for the URL\r\n * @return {Promise}        Returns a Promise containing\r\n *                          whatever the XMLHttpRequest returned\r\n */\r\nfunction make_flickr_api_request(method, param) {\r\n\treturn new Promise((resolve, reject) => {\r\n\t\tvar xhr = new XMLHttpRequest();\r\n\t\txhr.open('GET', make_flickr_url(method, param));\r\n\t\txhr.onload = function() {\r\n\t\t\tif(this.status >= 200 && this.status < 300) {\r\n\t\t\t\tresolve(xhr.response);\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\treject({status: this.status, statusText: xhr.statusText});\r\n\t\t\t}\r\n\t\t};\r\n\r\n\t\txhr.onerror = function() {\r\n\t\t\treject({status: this.status, statusText: xhr.statusText});\r\n\t\t};\r\n\r\n\t\txhr.send();\r\n\t});\r\n}\r\n\r\n/**\r\n * Gets the images based on the return value\r\n * of make_flickr_api_request. There's no error handling.\r\n * That's mainly due to lack of time. Sorry.\r\n *\r\n * The page parameter is not being dynamically assigned\r\n * from functions calling this function.\r\n * This is mainly due to lack of time as well.\r\n */\r\nexport function getImages(page) {\r\n\t// Here we're assiging an entire promise to the variable images.\r\n\t// At the end of this promise-chain, an array\r\n\t// containing object with the image URLs for thumbnail (a bit bigger)\r\n\t// and original size, as well as the image width and height.\r\n\t// \r\n\t// First search flickr using our helper method\r\n\tvar images = search_flickr().then((json_string) => {\r\n\t\t// Then parse the return value\r\n\t\treturn JSON.parse(json_string);\r\n\t}).then(images => {\r\n\t\t// Then return the array containing the photos\r\n\t\treturn images.photos.photo;\r\n\t}).then(photos => {\r\n\t\t// Then pick 5 photos starting from the first\r\n\t\t// photo on the page we're on (based on page arg)\r\n\t\tvar photos_array = [];\r\n\r\n\t\tvar photos_start = page * 5;\r\n\t\tvar photos_end = page * 5 + 5;\r\n\r\n\t\tif(photos_end > photos.length)\r\n\t\t\tphotos_end = photos.length;\r\n\r\n\t\tfor(var i = photos_start;i < photos_end;i++) {\r\n\t\t\tphotos_array.push(photos[i]);\r\n\t\t}\r\n\r\n\t\treturn photos_array;\r\n\t}).then(photos_array => {\r\n\t\t// Then get the image URL's for the thumbnail and canvas-image\r\n\t\t// based on the ID from photos saved in the previous step\r\n\t\tvar photos_array_string = [];\r\n\r\n\t\tfor(var i = 0;i < photos_array.length;i++) {\r\n\t\t\tphotos_array_string.push(getImage(photos_array[i].id));\r\n\t\t}\r\n\r\n\t\t// Since getImage returns a Promise, we resolve\r\n\t\t// all the promises in photos_array_string before passing\r\n\t\t// it on to the next step\r\n\t\treturn Promise.all(photos_array_string);\r\n\t}).then(photos_array_strings => {\r\n\t\t// And here we parse all the strings in the array\r\n\t\tvar photos_array = [];\r\n\r\n\t\tfor(var i = 0;i < photos_array_strings.length;i++) {\r\n\t\t\tphotos_array.push(JSON.parse(photos_array_strings[i]));\r\n\t\t}\r\n\r\n\t\treturn photos_array;\r\n\t}).then(photos_array => {\r\n\t\t// And here we save a thumbnail url, large image url, image width and height\r\n\t\t// to a photo_sources array, and then we pass it as a return value.\r\n\t\tvar photo_sources = [];\r\n\r\n\t\tfor(var i = 0;i < photos_array.length;i++) {\r\n\t\t\t// We chose to actually get all sizes rather than the image_context,\r\n\t\t\t// so we now have access to multiple image sizes.\r\n\t\t\tvar sizes_array = photos_array[i].sizes.size;\r\n\r\n\t\t\tvar thumbnail;\r\n\t\t\tvar large;\r\n\t\t\tvar width;\r\n\t\t\tvar height;\r\n\r\n\t\t\t// We loop through all the sizes, until we find\r\n\t\t\t// the small and original one.\r\n\t\t\t// \r\n\t\t\t// We should handle an error here in case an image\r\n\t\t\t// doesn't exist, but yeah.. I didn't, because I wanted to\r\n\t\t\t// prioritize other things. But some images don't\r\n\t\t\t// exist as small/ original (I think, because sometimes images\r\n\t\t\t// don't show up)\r\n\t\t\tfor(var n = 0; n < sizes_array.length;n++) {\r\n\t\t\t\tif(sizes_array[n].label == \"Small\") \r\n\t\t\t\t\tthumbnail = sizes_array[n].source;\r\n\t\t\t\t\r\n\t\t\t\tif(sizes_array[n].label == \"Original\") {\r\n\t\t\t\t\tlarge = sizes_array[n].source;\r\n\t\t\t\t\twidth = sizes_array[n].width;\r\n\t\t\t\t\theight = sizes_array[n].height;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t// Add image object to the images array\r\n\t\t\tphoto_sources.push({thumbnail, large, width, height});\r\n\t\t}\r\n\r\n\t\treturn photo_sources;\r\n\t});\r\n\r\n\t// Return the images array we made with the promise-chain above\r\n\treturn images;\r\n}\r\n\r\n/**\r\n * Just a short method for making a search API request\r\n * to flickr\r\n */\r\nfunction search_flickr(tags) {\r\n\treturn make_flickr_api_request(\"flickr.photos.search\", tags);\r\n}\r\n\r\n/**\r\n * Just a short method for making a getImage API request\r\n * to flickr\r\n */\r\nfunction getImage(id) {\r\n\treturn make_flickr_api_request(\"flickr.photos.getSizes\", id);\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/js/flickr.js","import {canvas, draw_canvas, ctx, draw_canvas_ctx, tools} from './variables';\r\nimport Filter from './canvas_tools';\r\n\r\nconst thumbnails_container = document.querySelector(\".thumbnails_container\");\r\n\r\nexport let img_width, img_height, img_src;\r\n\r\n/**\r\n * Helper method to change the size of the canvas, as well\r\n * as the size of the draw_canvas, which is used to draw on with\r\n * a \"pen-tool\".\r\n */\r\nexport function change_canvas_size(width = canvas_container.offsetWidth, height = canvas_container.offsetHeight) {\r\n\tif(width > canvas_container.offsetWidth)\r\n\t\twidth = canvas_container.offsetWidth;\r\n\tif(height > canvas_container.offsetHeight)\r\n\t\theight = canvas_container.offsetHeight;\r\n\r\n\tcanvas.width = width;\r\n\tcanvas.height = height;\r\n\tdraw_canvas.width = width;\r\n\tdraw_canvas.height = height;\r\n}\r\n\r\n/**\r\n * Helper method to generate the image-thumnails-list\r\n * when a search string is entered\r\n * @param  {array} images The images to display\r\n */\r\nexport function make_image_list(images) {\r\n\tthumbnails_container.innerHTML = \"\";\r\n\r\n\tfor(var i = 0;i < images.length;i++) {\r\n\t\tvar thumbnail = document.createElement('img');\r\n\r\n\t\tthumbnail.setAttribute(\"src\", images[i].thumbnail);\r\n\t\tthumbnail.setAttribute(\"alt\", \"Image thumbnail\");\r\n\t\tthumbnail.setAttribute(\"class\", \"image\");\r\n\t\tthumbnail.setAttribute(\"data-large\", images[i].large);\r\n\t\tthumbnail.setAttribute(\"data-width\", images[i].width);\r\n\t\tthumbnail.setAttribute(\"data-height\", images[i].height);\r\n\r\n\t\tthumbnails_container.appendChild(thumbnail).addEventListener('click', function() {\r\n\t\t\tchange_canvas_size(this.dataset.width, this.dataset.height);\r\n\t\t\tload_image(this.dataset.large);\r\n\t\t\tcanvas.setAttribute(\"data-source\", this.dataset.large);\r\n\t\t});\r\n\t}\r\n}\r\n\r\n/**\r\n * Load an image to the canvas based on a URL.\r\n * Uses img.crossOrigin to allow us to read the imageData.\r\n * Globally changes img_width and img_height.\r\n * Clears Filter.points() so whatever we drew will be gone.\r\n */\r\nfunction load_image(url) {\r\n\tvar img = new Image();\r\n\r\n\timg.addEventListener(\"load\", function() {\r\n\t\timg_width = img.width;\r\n\t\timg_height = img.height;\r\n\t\tchange_canvas_size(img_width, img_height);\r\n\t\tctx.clearRect(0, 0, img_width, img_height);\r\n\t\tdraw_canvas_ctx.clearRect(0, 0, img_width, img_height);\r\n\t\tFilter.options.points = [];\r\n\t\tctx.drawImage(img, 0, 0, img_width, img_height,\r\n\t\t\t\t\t  0, 0, canvas.width, canvas.height);\r\n\t\timg_src = url;\r\n\t\ttools.style = \"\";\r\n\t});\r\n\r\n\timg.crossOrigin = '';\r\n\timg.src = url;\r\n\r\n\treturn img;\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/js/canvas.js","import {img_width, img_height, img_src} from './canvas';\r\nimport {draw_canvas, draw_canvas_ctx, canvas, ctx, brightness_slider, white_balance_slider} from './variables';\r\n\r\nfunction Filters() {\r\n\tthis.options = {\r\n\t\timg: \"\",\r\n\t\timage_flipped: false,\r\n\t\tbrightness_value: brightness_slider.value,\r\n\t\ttemp: white_balance_slider.value,\r\n\t\tdraw_toggled: false,\r\n\t\tpoints: [],\r\n\t\tdrawing: false\r\n\t}\r\n\r\n\tthis.undo_stack = [];\r\n\tthis.redo_stack = [];\r\n};\r\n\r\n/**\r\n * Method to flip the canvas image\r\n */\r\nFilters.prototype.flip_image = function(img) {\r\n\tctx.save();\r\n\t\tif(this.options.image_flipped) {\r\n\t\t\tctx.translate(canvas.width, 0);\r\n\t\t\tctx.scale(-1, 1);\r\n\t\t}\r\n\r\n\t\tctx.drawImage(img, 0, 0, img_width, img_height,\r\n\t\t\t\t\t  0, 0, canvas.width, canvas.height);\r\n\tctx.restore();\r\n}\r\n\r\n/**\r\n * Method to convert a temperature to RGB for use in Filters.white_balance().\r\n * I stole this algorithm from the link below\r\n * \r\n * https://github.com/licson0729/CanvasEffects/blob/master/CanvasEffects.js\r\n *\r\n * @return {Object} Returns an object containing RGB\r\n */\r\nFilters.prototype.color_temp_to_RGB = function(temp) {\r\n\ttemp /= 100;\r\n\tvar r, g, b;\r\n\r\n\tif (temp <= 66) {\r\n\t\tr = 255;\r\n\t\tg = Math.min(Math.max(99.4708025861 * Math.log(temp) - 161.1195681661, 0), 255);\r\n\t} else {\r\n\t\tr = Math.min(Math.max(329.698727446 * Math.pow(temp - 60, -0.1332047592), 0), 255);\r\n\t\tg = Math.min(Math.max(288.1221695283 * Math.pow(temp - 60, -0.0755148492), 0), 255);\r\n\t}\r\n\r\n\tif (temp >= 66) {\r\n\t\tb = 255;\r\n\t} else if (temp <= 19) {\r\n\t\tb = 0;\r\n\t} else {\r\n\t\tb = temp - 10;\r\n\t\tb = Math.min(Math.max(138.5177312231 * Math.log(b) - 305.0447927307, 0), 255);\r\n\t}\r\n\r\n\treturn {\r\n\t\tr: r,\r\n\t\tg: g,\r\n\t\tb: b\r\n\t}\r\n}\r\n\r\n/**\r\n * Method to adjust brightness. Stolen from: \r\n * https://github.com/licson0729/CanvasEffects/blob/master/CanvasEffects.js\r\n *\r\n * Because algorithms isn't my forte.\r\n */\r\nFilters.prototype.brightness = function() {\t\r\n\tvar brightness = this.options.brightness_value / 100;\r\n\r\n\treturn this.process(function(r, g, b, a) {\r\n\t\treturn [r * brightness, g * brightness, b * brightness, a];\r\n\t});\r\n}\r\n\r\n/**\r\n * Method to adjust white_balance. Stolen from: \r\n * https://github.com/licson0729/CanvasEffects/blob/master/CanvasEffects.js\r\n *\r\n * Because algorithms isn't my forte.\r\n */\r\nFilters.prototype.white_balance = function() {\r\n\tvar color = this.color_temp_to_RGB(this.options.temp);\r\n\treturn this.process(function(r, g, b, a) {\r\n\t\tvar nr = r * (255 / color.r);\r\n\t\tvar ng = g * (255 / color.g);\r\n\t\tvar nb = b * (255 / color.b);\r\n\t\treturn [nr, ng, nb, a];\r\n\t});\r\n}\r\n\r\n/**\r\n * Method to draw on a second canvas layer (not the one hosting the image)\r\n * Decides where to draw based on the values of this.options.points\r\n */\r\nFilters.prototype.draw = function() {\r\n\tdraw_canvas_ctx.clearRect(0, 0, img_width, img_height);\r\n\r\n\tfor(var i = 0;i < this.options.points.length;i++) {\r\n\t\tvar point = this.options.points[i];\r\n\t\tdraw_canvas_ctx.beginPath();\r\n\t\t\tdraw_canvas_ctx.arc(point.x, point.y, point.size, 0, 2 * Math.PI, );\r\n\t\t\tdraw_canvas_ctx.fill();\r\n\t\tdraw_canvas_ctx.closePath();\r\n\t}\r\n}\r\n\r\n/**\r\n * Method to loop through all the pixels on the canvas image and apply\r\n * a function to them. Stolen from:\r\n *\r\n * https://github.com/licson0729/CanvasEffects/blob/master/CanvasEffects.js\r\n * \r\n * I know I could have written this myself, but I found it, and it\r\n * was being used by the other algorithms that I found there,\r\n * so I decided to use it and make some slight modifications to it.\r\n */\r\nFilters.prototype.process = function(func) {\r\n\t//Get the pixel values\r\n\tvar image_data = ctx.getImageData(0, 0, img_width, img_height);\r\n\tvar data = image_data.data;\r\n\r\n\t//Loop through the pixels\r\n\tfor (var row = 0; row < image_data.height; row++) {\r\n\t\tfor (var column = 0; column < image_data.width; column++) {\r\n\t\t\tvar i = (column * image_data.height + row) * 4;\r\n\t\t\tvar r = data[i],\r\n\t\t\t\tg = data[i + 1],\r\n\t\t\t\tb = data[i + 2],\r\n\t\t\t\ta = data[i + 3];\r\n\r\n\t\t\tvar ret = func(r, g, b, a, row, column);\r\n\t\t\timage_data.data[i] = ret[0];\r\n\t\t\timage_data.data[i + 1] = ret[1];\r\n\t\t\timage_data.data[i + 2] = ret[2];\r\n\t\t\timage_data.data[i + 3] = ret[3];\r\n\t\t}\r\n\t}\r\n\r\n\t//Put the image back to the canvas\r\n\tctx.putImageData(image_data, 0, 0);\r\n}\r\n\r\n/**\r\n * Method to download the image\r\n */\r\nFilters.prototype.save = function(link) {\r\n\tvar filename = + new Date()+\".png\";\r\n\r\n\tctx.drawImage(draw_canvas, 0, 0);\r\n\tlink.href = canvas.toDataURL();\r\n\tlink.download = filename;\r\n}\r\n\r\n/**\r\n * Method to add previous options state to undo_stack\r\n * Resets the redo_stack to be empty.\r\n */\r\nFilters.prototype.add_to_history = function() {\r\n\tthis.redo_stack = [];\r\n\tconsole.log(this.options.image_flipped);\r\n\tthis.undo_stack = [...this.undo_stack, {\r\n\t\timg: this.options.img,\r\n\t\timage_flipped: this.options.image_flipped,\r\n\t\tbrightness_value: this.options.brightness_value,\r\n\t\ttemp: this.options.temp,\r\n\t\tdraw_toggled: this.options.draw_toggled,\r\n\t\tpoints: this.options.points\r\n\t}];\r\n}\r\n\r\n/**\r\n * Method to undo. Adds current options state to redo_stack\r\n * Changes current options state to be what's last in the undo_stack\r\n */\r\nFilters.prototype.undo = function () {\r\n\tif(this.undo_stack.length) {\r\n\t\tthis.redo_stack = [...this.redo_stack, this.options];\r\n\r\n\t\tvar options = this.options;\r\n\t\tvar popped_undo_stack = this.undo_stack.pop();\r\n\r\n\t\tvar new_options = Object.assign({}, options, popped_undo_stack);\r\n\t\tthis.options = new_options;\r\n\t}\r\n\r\n\tthis.set_sliders();\r\n}\r\n\r\n/**\r\n * Method to redo. Adds current options state to undo_stack\r\n * Changes current options state to be what's last in the redo_stack\r\n */\r\nFilters.prototype.redo = function () {\r\n\tif(this.redo_stack.length) {\t\r\n\t\tthis.undo_stack = [...this.undo_stack, this.options];\r\n\r\n\t\tvar options = this.options;\r\n\t\tvar popped_redo_stack = this.redo_stack.pop();\r\n\r\n\t\tvar new_options = Object.assign({}, options, popped_redo_stack);\r\n\t\tthis.options = new_options;\r\n\t}\r\n\t\r\n\tthis.set_sliders();\r\n}\r\n\r\n/**\r\n * Method to set the sliders to the values given when undoing/ redoing\r\n */\r\nFilters.prototype.set_sliders = function() {\r\n\twhite_balance_slider.value = this.options.temp;\r\n\tbrightness_slider.value = this.options.brightness_value;\r\n}\r\n\r\n/**\r\n * Method to render a new image with all filter settings\r\n */\r\nFilters.prototype.render = function() {\r\n\tvar img = new Image();\r\n\tthis.options.img = img;\r\n\r\n\timg.addEventListener('load', () => {\r\n\t\tctx.clearRect(0, 0, img_width, img_height);\r\n\t\tthis.flip_image(img);\r\n\t\tthis.brightness();\r\n\t\tthis.white_balance();\r\n\t\tthis.draw();\r\n\t});\r\n\r\n\timg.crossOrigin = '';\r\n\timg.src = img_src;\r\n}\r\n\r\n/**\r\n * Export the Filters object as Filter for use in other files\r\n */\r\n\r\nconst Filter = new Filters()\r\nexport default Filter;\n\n\n// WEBPACK FOOTER //\n// ./src/js/canvas_tools.js","import {search_form, canvas, white_balance_slider, draw, draw_canvas} from './variables';\r\nimport {getImages} from './flickr';\r\nimport {make_image_list} from './canvas';\r\n\r\nimport Filter from './canvas_tools';\r\n\r\nexport default function make_event_listeners() {\r\n\t/**\r\n\t * Event-listener that listens to the submission of the search form\r\n\t */\r\n\tsearch_form.addEventListener('submit', function(e) {\r\n\t\te.preventDefault();\r\n\t\tgetImages(0).then((images) => {\r\n\t\t\tmake_image_list(images);\r\n\t\t});\r\n\t}, false);\r\n\r\n\t/**\r\n\t * Toggle the Filter.options.image_flipped when \"flip image\" is clicked\r\n\t */\r\n\tdocument.querySelector('.flip').addEventListener('click', function() {\r\n\t\tFilter.add_to_history();\r\n\t\tFilter.options.image_flipped = !Filter.options.image_flipped;\r\n\t\tFilter.render();\r\n\t});\r\n\r\n\t/**\r\n\t * Event-listener for undo-button\r\n\t */\r\n\tdocument.querySelector('.undo').addEventListener('click', function() {\r\n\t\tFilter.undo();\r\n\t\tFilter.render();\r\n\t});\r\n\r\n\t/**\r\n\t * Event-listener for redo-button\r\n\t */\r\n\tdocument.querySelector('.redo').addEventListener('click', function() {\r\n\t\tFilter.redo();\r\n\t\tFilter.render();\r\n\t});\r\n\r\n\t/**\r\n\t * Event-listener for save-button\r\n\t */\r\n\tdocument.querySelector('.save').addEventListener('click', function() {\r\n\t\tFilter.save(this);\r\n\t\tFilter.render();\r\n\t});\r\n\r\n\r\n\t/**\r\n\t * When the user presses the mouse-button while on the canvas,\r\n\t * let the script know we intend to draw\r\n\t */\r\n\tdraw_canvas.addEventListener('mousedown', function() {\r\n\t\tFilter.add_to_history();\r\n\t\tFilter.options.drawing = true;\r\n\t});\r\n\r\n\t/**\r\n\t * When the user is no longer pressing the mouse, we\r\n\t * set the drawing option to false\r\n\t */\r\n\tdraw_canvas.addEventListener('mouseup', function() {\r\n\t\tFilter.options.drawing = false;\r\n\t});\r\n\r\n\t/**\r\n\t * If the drawing-option is true, and we have activated the\r\n\t * draw button in the tools panel, register mouse position as\r\n\t * points\r\n\t */\r\n\tdraw_canvas.addEventListener('mousemove', function(e) {\r\n\t\tif(Filter.options.drawing && Filter.options.draw_toggled) {\r\n\t\t\tvar {x, y} = getMouseXY(e);\r\n\t\t\tvar size = 10;\r\n\r\n\t\t\tconst draw_points = Filter.options.points;\r\n\t\t\tconst new_points = [...draw_points, { x, y, size }];\r\n\t\t\tFilter.options.points = new_points;\r\n\t\t\tFilter.render();\r\n\t\t}\r\n\t});\r\n\r\n\t/**\r\n\t * Toggle draw to ensure the application that you would like to draw\r\n\t * Because just relying on mouse down and mouse up would not be such a good idea\r\n\t *\r\n\t * Make it look cool with a style when it's toggled\r\n\t */\r\n\tdraw.addEventListener('click', function() {\r\n\t\tFilter.options.draw_toggled = !Filter.options.draw_toggled;\r\n\r\n\t\tif(Filter.options.draw_toggled) {\r\n\t\t\tthis.classList.add('active');\r\n\t\t} else {\r\n\t\t\tthis.classList.remove('active');\r\n\t\t}\r\n\r\n\t\tFilter.render();\r\n\t});\r\n\r\n\t/**\r\n\t * Set the temperature for white balance, based on the value\r\n\t * of the White Balance slider. Duhh\r\n\t */\r\n\twhite_balance_slider.addEventListener('change', function() {\r\n\t\tFilter.add_to_history();\r\n\t\tFilter.options.temp = this.value;\r\n\t\tFilter.render();\r\n\t});\r\n\r\n\t/**\r\n\t * Set the brightness the image, based on the value\r\n\t * of the brightness slider.\r\n\t */\r\n\tbrightness_slider.addEventListener('change', function() {\r\n\t\tFilter.add_to_history();\r\n\t\tFilter.options.brightness_value = this.value;\r\n\t\tFilter.render();\r\n\t})\r\n}\r\n\r\n/**\r\n * Returns an object with the x and y positions\r\n * of a mouse event\r\n */\r\nfunction getMouseXY(e) {\r\n\tvar x;\r\n\tvar y;\r\n\r\n\tif (e.pageX || e.pageY) { \r\n\t\tx = e.pageX;\r\n\t\ty = e.pageY;\r\n\t}\r\n\telse { \r\n\t\tx = e.clientX + document.body.scrollLeft + document.documentElement.scrollLeft; \r\n\t\ty = e.clientY + document.body.scrollTop + document.documentElement.scrollTop; \r\n\t}\r\n\r\n\tx -= canvas.offsetLeft;\r\n\ty -= canvas.offsetTop;\r\n\r\n\treturn({x, y});\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/js/event_listeners.js"],"sourceRoot":""}